# 多连接功能测试清单

## 测试步骤

### 1. 激活多个连接
- [ ] 打开连接管理器
- [ ] 确认至少有2个可用连接（ob测试 MySQL 和 本地sqlite）
- [ ] 激活两个连接（点击开关按钮）
- [ ] 验证两个连接的 is_active 状态都变为 true

### 2. DatabaseTree 显示多个连接
- [ ] 查看左侧数据库树
- [ ] 应该看到两个连接节点：
  - ob测试 (MySQL)
    - demo
      - student 表
  - 本地sqlite (SQLite)
    - test.db
      - (如果有表则显示)
- [ ] 展开每个连接的表结构
- [ ] 验证字段和索引可以正常加载

### 3. 查询标签独立选择连接
- [ ] 打开第一个查询标签
- [ ] 从连接选择器中选择 "ob测试"
- [ ] 创建新查询标签
- [ ] 在新标签中选择 "本地sqlite"
- [ ] 验证两个标签的连接选择是独立的

### 4. 执行SQL查询
- [ ] 在连接到 MySQL 的标签中执行：`SELECT * FROM student`
- [ ] 验证查询成功，显示数据
- [ ] 在连接到 SQLite 的标签中执行适当的查询
- [ ] 验证查询成功

### 5. AI 生成 SQL
- [ ] 在连接到 MySQL 的标签中
- [ ] 输入自然语言："查询所有学生"
- [ ] 点击 AI 生成
- [ ] 验证生成的 SQL：`SELECT * FROM student;`
- [ ] 验证 AI 使用的是正确的连接和表结构

### 6. 切换标签保持连接
- [ ] 在标签1选择连接A
- [ ] 在标签2选择连接B
- [ ] 切换回标签1
- [ ] 验证连接仍然是A
- [ ] 切换到标签2
- [ ] 验证连接仍然是B

### 7. 停用连接
- [ ] 停用其中一个连接
- [ ] 验证 DatabaseTree 只显示剩余的活动连接
- [ ] 验证查询标签的连接选择器只显示活动连接
- [ ] 如果当前标签使用的连接被停用，应自动切换到其他活动连接

## 预期结果

✅ 所有测试通过表明多连接功能正常工作
- 后端 API 正确处理 connection_id 参数
- 前端正确维护每个标签的独立连接选择
- DatabaseTree 正确显示所有活动连接
- AI 功能使用正确的连接上下文

## 已知问题

- 无

## 测试日期：2025-11-15
